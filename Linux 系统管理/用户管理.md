# 概念
## 用户分类

Linux 用户可分为两类：
- 管理员用户：UID 为 0 的用户，一般为 root；
- 普通用户：UID 在 1 - 65535 之间；

普通用户按 UID 范围又可分为两类（以 CentOS 7 及 Ubuntu 20 为例）：
- 系统用户：UID 范围为 1-999；
- 登录用户：UID >= 1000；
## 用户组
用户和组是多对多的关系（类似角色的概念）：
- 一个用户可以属于多个组；
- 一个组也可以拥有多个用户；

Linux 用户组可分为两类：
- 管理员组：包含 UID 为 0 的用户，GID 固定为 0；
- 普通组：GID 在 1 - 65535 之间；

普通组按 GID 范围又可分为两类：
- 系统组：GID 范围为 1-999；
- 普通组：GID >= 1000；

用户组按使用场景也可分为两类：
- 基本组：也叫做主组，用户的主组 GID 通常和用户的 UID 相同，主组 GID >= 1000；
- 附加组：一个用户只能有一个主组，如果还要把它归于其它组的成员，那么其它组就为附加组，附加组 GID 通常也是 >= 1000；

例：把 zze 添加到 root 组：
```bash
$ usermod -aG root zze
```
## 相关配置文件

用户的账号、组的相关信息都是保存在 /etc 下的某些配置文件中：
### /etc/passwd

保存了所有用户的基本配置信息（无敏感信息）；
```
root:x:0:0:root:/root:/bin/bash
zze:x:1000:1000::/home/zze:/bin/sh

用户名:密码占位符:用户ID:组ID:用户全名:家目录:登录Shell
```
- 用户名（Username）：用户账号的名称，用于登录系统。
- 密码占位符（Password）：在现代系统中，这个字段通常包含一个"x"，表示密码已被移到了 `/etc/shadow `文件中加密存储，以增强安全性。
- 用户ID（UID）：一个唯一的数字标识，用于识别用户。0为root用户，普通用户ID通常从1000开始。
- 组ID（GID）：用户的基本组的ID，决定了用户所属的初始组，与`/etc/group`文件中的组信息相匹配。
- 用户全名（User Info或GECOS）：用户的全名、办公室、电话等描述性信息。
- 家目录（Home Directory）：用户登录后的默认工作目录。
- 登录Shell：用户登录后默认使用的shell类型，如`/bin/bash`。如果这一项被设置为非交互式shell（如`/sbin/nologin`或`/bin/false`），则用户无法登录系统。

### /etc/group
保存了用户组信息。
```
root:x:0:
zze:x:1000:

组名:密码占位符:组ID:附属用户列表
```

- 组名（Group Name）：用户组的名称，用于标识该组。
- 密码占位符（Password）：传统上用于存储组密码，但在现代系统中通常为空（表示没有密码）或者使用"x"，实际密码（如果有）会存储在`/etc/gshadow`或`/etc/gshadow`类似的文件中。
- 组ID（GID, Group ID, GID）：一个整数，用于唯一标识组。系统内部使用GID来确定文件和进程的组所有权。通常，非系统组的GID从500开始。
- 附属用户列表（Members）：属于该组的用户列表（以该组为附加组的用户列表），用户名之间用逗号（,）分隔。用户可以属于多个组，其主组在`/etc/passwd`文件中指定，而其他附加组则列于此处。

> 组密码用于限制用户加入或管理特定用户组的权限，用户想要通过`newgrp`命令临时加入该组时，需要提供组密码验证。

### /etc/shadow
保存了用户认证信息。

```
root:$6$M/yGAzfVNQEzv4i7$3g3nhEm/iL6C39pln6pQp0U8cY1K4GmmW21WdKgqfVgnzM8sr4.ILQ9oVYzg9l0Qb5ghJ0HoGmVKwf2jaHIty1:19318:0:99999:7:::
zze:$6$8JZVKI18r3jxdH9H$ZWCTdoIgkF6owXoa0fnqUfIdSzbgZmGqWihR3/Mi3HjbNpwGKHG4AlaO3Z.IKdaZtTe2VdZE5iuaePssgBT1:19865:0:99999:7:::

用户名:加密密码:最后一次修改密码时间:最小密码年龄:最大密码年龄:警告期:不活动期限:失效日期:保留字段
```

- 用户名（Login Name）：与`/etc/passwd`文件中的用户名相匹配。
- 加密密码（Encrypted Password）：用户的密码散列，通常是加密后的哈希值，也可能包含特殊字符如感叹号（!或*）表示密码被锁定或禁用。
- 最后一次密码修改时间（Last Password Change）：自从Unix纪元年（1970年1月1日）以来的天数，表示上一次密码修改的日期。
- 最小密码年龄（Minimum Age）：密码最早可以再次修改前需要等待的天数。
- 最大密码年龄（Maximum Age）：密码必须被更换前的天数，超过后密码将过期。
- 警告期（Warning Period）：密码过期前，提前多少天开始提醒用户密码即将过期。
- 不活动期限（Inactivity Period）：密码过期后多少天，账户变为非活动状态。
- 失效日期（Expiration Date）：账户失效的绝对日期，自Unix纪元年开始的天数，账户过期后无法再登录。
- 保留字段（Reserved）：备用字段，目前通常未使用。

### /etc/gshadow
保存了用户组认证信息。

```
root:*::
zze:!::

组名:加密密码:组管理用户列表:组成员列表
```
- 组名（Group Name）：组的名称。
- 加密密码（Encrypted Password）：经过加密的组密码。
- 组管理用户列表（Group Administrators）：可以管理该组的用户列表。
- 组成员列表（Group Members）：该组的成员列表。

## 进程权限
我们对计算机的操作是通过运行程序完成的（比如我们当前通过终端操作的 Shell 也是一个和程序），运行起来的程序称为进程（process）。
而进程则一定是以发起者用户的身份来运行的，进程所拥有的权限就是发起者用户身份拥有的权限。

**进程拥有访问哪些资源的权限取决于进程发起者的身份。**
